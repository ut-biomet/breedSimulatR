<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>`breedSimulatR` Example • breedSimulatR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="`breedSimulatR` Example">
<meta property="og:description" content="breedSimulatR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">breedSimulatR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://github.com/ut-biomet/breedSimulatR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="example_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>
<code>breedSimulatR</code> Example</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ut-biomet/breedSimulatR/blob/master/vignettes/example.Rmd" class="external-link"><code>vignettes/example.Rmd</code></a></small>
      <div class="hidden name"><code>example.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor" aria-hidden="true"></a>Introduction</h1>
<p><code>breedSimulatR</code> is R package providing classes and functions to simulate breeding schemes. It have been design to be intuitive and easy to use.</p>
<p>The Object-Oriented Programming (OOP) system used in this package is <a href="https://CRAN.R-project.org/package=R6" class="external-link">R6</a>. Information about R6 OOP system can be found at <a href="https://adv-r.hadley.nz/r6.html" class="external-link">chapter 14 of Hadley Wickham’s book <em>Advanced R</em></a>.</p>
<p>This vignette shows how to use the <code>breedSimulatR</code> package thought basic examples.</p>
<div id="breedsimulatrs-classes" class="section level2">
<h2 class="hasAnchor">
<a href="#breedsimulatrs-classes" class="anchor" aria-hidden="true"></a><code>breedSimulatR</code>’s classes</h2>
<p>First let’s have a look on the main classes provided by <code>breedSimulatR</code>:</p>
<ul>
<li>
<a href="https://ut-biomet.github.io/breedSimulatR/reference/specie.html"><code>Specie</code></a>: which store specific information about the studied specie like number of chromosomes, length of chromosomes in base pairs and centimorgans, their names</li>
<li>
<a href="https://ut-biomet.github.io/breedSimulatR/reference/SNPinfo.html"><code>SNPinfo</code></a>: which store specific information about a set of SNP markers like physical positions, linkage map position, IDs</li>
<li>
<a href="https://ut-biomet.github.io/breedSimulatR/reference/individual.html"><code>individuals</code></a>: which store specific information about an individual like its parents, its haplotype. This class have also a method to generate gametes.</li>
<li>
<a href="https://ut-biomet.github.io/breedSimulatR/reference/population.html"><code>population</code></a>: which store specific information several individuals like their genotypes, allele frequency</li>
<li>
<a href="https://ut-biomet.github.io/breedSimulatR/reference/trait.html"><code>trait</code></a>: which store specific information about a trait like the QTN involved, the QTN’s effects</li>
<li>
<a href="https://ut-biomet.github.io/breedSimulatR/reference/phenotyper.html"><code>phenotyper</code></a>: This object is used to simulate phenotyping experiments and store store some specific information like the variance of the environmental effect and have method to phenotype individuals. Several phenotyper can be created to represents several environments.</li>
</ul>
<p>A exhaustive list can be fond on the package’s <a href="https://ut-biomet.github.io/breedSimulatR/reference/index.html">web site</a>.</p>
</div>
<div id="example-data" class="section level2">
<h2 class="hasAnchor">
<a href="#example-data" class="anchor" aria-hidden="true"></a>Example data</h2>
<p>The package contains some example data that we will use for these examples. These data are stored in the variable <code>exampleData</code> of the package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ut-biomet/breedSimulatR" class="external-link">breedSimulatR</a></span><span class="op">)</span>
<span class="va">exampleData</span></code></pre></div>
<p><code>exampleData</code> is a list containing 3 elements:</p>
<ul>
<li>
<code>exampleData$genotypes</code>: contains some genotypic.</li>
<li>
<code>exampleData$snpCoord</code>: contains the coordinates of the SNP markers.</li>
<li>
<code>exampleData$snpEffects</code>: contains the “true” effects of the SNP markers for a quantitative trait based on an additive architecture.</li>
</ul>
<p>It represents information about <code>.nInd</code> individuals and <code>.nSNP</code> markers on <code>.nChr</code>.</p>
<p>These data are fictitious and come from the serious game <a href="https://github.com/timflutre/PlantBreedGame" class="external-link">“PlantBreedGame”</a> <span class="citation">(Flutre, Diot, and David 2019)</span>.</p>
</div>
</div>
<div id="simulation-initialization" class="section level1">
<h1 class="hasAnchor">
<a href="#simulation-initialization" class="anchor" aria-hidden="true"></a>Simulation Initialization</h1>
<p>In order to run some simulation, we must first initialize some objects: a <code>specie</code>, SNP information (<code>SNPinfo</code>), a <code>population</code>, some <code>traits</code> and a <code>phenotyper</code>.</p>
<div id="specie-specification" class="section level2">
<h2 class="hasAnchor">
<a href="#specie-specification" class="anchor" aria-hidden="true"></a>Specie specification</h2>
<p>The example’s specie, let’s name it <em>Statisticae exempli</em>, have <strong>10 chromosomes</strong> with the same length of around <strong>1e+06</strong> base pairs for <strong>100</strong> centimorgans.</p>
<p>The function <code>specie$new</code> will create a new <code>specie</code> object <code>specie_statEx</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create specie object</span>
<span class="va">specie_statEx</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/specie.html">specie</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>specName <span class="op">=</span> <span class="st">"Statisticae exempli"</span>,
                            nChr <span class="op">=</span> <span class="fl">10</span>,
                            lchr <span class="op">=</span> <span class="fl">1e6</span>,
                            lchrCm <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="co">#&gt; A new species has emerged: Statisticae exempli !</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">specie_statEx</span><span class="op">)</span>
<span class="co">#&gt; Name: Statisticae exempli</span>
<span class="co">#&gt; Number of Chromosomes: 10</span>
<span class="co">#&gt; Ploidy: 2</span>
<span class="co">#&gt; Chromosome length:</span>
<span class="co">#&gt;       chrNames chrLength chrLengthCm</span>
<span class="co">#&gt; Chr01    Chr01     1e+06         100</span>
<span class="co">#&gt; Chr02    Chr02     1e+06         100</span>
<span class="co">#&gt; Chr03    Chr03     1e+06         100</span>
<span class="co">#&gt; Chr04    Chr04     1e+06         100</span>
<span class="co">#&gt; Chr05    Chr05     1e+06         100</span>
<span class="co">#&gt; Chr06    Chr06     1e+06         100</span>
<span class="co">#&gt; Chr07    Chr07     1e+06         100</span>
<span class="co">#&gt; Chr08    Chr08     1e+06         100</span>
<span class="co">#&gt;  [ reached 'max' / getOption("max.print") -- omitted 2 rows ]</span></code></pre></div>
</div>
<div id="snp-specification" class="section level2">
<h2 class="hasAnchor">
<a href="#snp-specification" class="anchor" aria-hidden="true"></a>SNP specification</h2>
<p>In order to simulate the crossing between individuals, we need information about the positions of the genotypic markers used in the simulation. We will create for that the object <code>SNPinfo</code> using the function <code>SNPinfo$new</code>.</p>
<ul>
<li>
<code>SNPcoord</code>: a <code>data.frame</code> with one line per marker and 4 columns:
<ul>
<li>
<code>chr</code>: Chromosome holding the SNP</li>
<li>
<code>physPos</code>: SNP physical position on the chromosome</li>
<li>
<code>linkMapPos</code>: SNP linkage map position on the chromosome</li>
<li>
<code>SNPid</code>: SNP’s IDs</li>
</ul>
</li>
<li>
<code>specie</code>: an object of class specie.</li>
</ul>
<p>We can create the <code>SNPinfo</code> object using <code>exampleData$snpCoord</code> which is a <code>data.frame</code> matching the requirement of <code>SNPinfo$new</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># data preview</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">exampleData</span><span class="op">$</span><span class="va">snpCoord</span><span class="op">)</span>
<span class="co">#&gt;      chr physPos linkMapPos    SNPid</span>
<span class="co">#&gt; 2  Chr01  937638   86.81546 snp03760</span>
<span class="co">#&gt; 6  Chr01  654763   56.51842 snp02674</span>
<span class="co">#&gt; 10 Chr01  181658   30.62157 snp00721</span>
<span class="co">#&gt; 18 Chr01  230126   35.47120 snp00948</span>
<span class="co">#&gt; 26 Chr01  420637   46.98455 snp01620</span>
<span class="co">#&gt; 29 Chr01  467620   48.80905 snp01790</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create SNPinfo object</span>
<span class="va">SNPs</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/SNPinfo.html">SNPinfo</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>SNPcoord <span class="op">=</span> <span class="va">exampleData</span><span class="op">$</span><span class="va">snpCoord</span>,
                    specie <span class="op">=</span> <span class="va">specie_statEx</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">SNPs</span><span class="op">)</span>
<span class="co">#&gt; specie: Statisticae exempli</span>
<span class="co">#&gt; 3333 Markers on 10 chromosomes :</span>
<span class="co">#&gt; Chr01 Chr02 Chr03 Chr04 Chr05 Chr06 Chr07 Chr08 Chr09 Chr10 </span>
<span class="co">#&gt;   415   247   425   322   381   269   238   355   342   339 </span>
<span class="co">#&gt; SNPcoord:</span>
<span class="co">#&gt;        chr physPos linkMapPos    SNPid</span>
<span class="co">#&gt; 338  Chr01    2068  0.4911687 snp00006</span>
<span class="co">#&gt; 1450 Chr01    2708  0.6423784 snp00009</span>
<span class="co">#&gt; 1391 Chr01    2782  0.6598378 snp00011</span>
<span class="co">#&gt; 2475 Chr01    4159  0.9838113 snp00018</span>
<span class="co">#&gt; 1553 Chr01    6917  1.6275084 snp00026</span>
<span class="co">#&gt; 2365 Chr01    7814  1.8353769 snp00031</span>
<span class="co">#&gt;  [ reached 'max' / getOption("max.print") -- omitted 3327 rows ]</span></code></pre></div>
</div>
<div id="population-initialization" class="section level2">
<h2 class="hasAnchor">
<a href="#population-initialization" class="anchor" aria-hidden="true"></a>Population initialization</h2>
<p>We can now generate an initial population from genotypic data. We will use the function <code>createPop</code>. This function will create a <code>population</code> object from at least two arguments:</p>
<ul>
<li>
<code>geno</code>: a <code>data.frame</code> of the genotypic data of homozygotes individuals</li>
<li>
<code>SNPinfo</code>: a <code>SNPinfo</code> object containing the information related to the markers of the genotypic data</li>
</ul>
<p>We can create the initial <code>population</code> object using <code>exampleData$genotypes</code> which is a <code>data.frame</code> matching the requirement of <code>geno</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># data preview</span>
<span class="va">exampleData</span><span class="op">$</span><span class="va">genotypes</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>
<span class="co">#&gt;          snp00006 snp00009 snp00011 snp00018 snp00026</span>
<span class="co">#&gt; Coll0001        2        2        2        0        2</span>
<span class="co">#&gt; Coll0002        0        2        2        2        0</span>
<span class="co">#&gt; Coll0003        2        2        2        0        2</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create population object</span>
<span class="va">initPop</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createPop.html">createPop</a></span><span class="op">(</span>geno <span class="op">=</span> <span class="va">exampleData</span><span class="op">$</span><span class="va">genotypes</span>,
                     SNPinfo <span class="op">=</span> <span class="va">SNPs</span>,
                     popName <span class="op">=</span> <span class="st">"Initial population"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">initPop</span><span class="op">)</span>
<span class="co">#&gt; Population: Initial population</span>
<span class="co">#&gt; Species: Statisticae exempli</span>
<span class="co">#&gt; Number of individuals: 100</span></code></pre></div>
</div>
<div id="traits-and-phenotyping-initialization" class="section level2">
<h2 class="hasAnchor">
<a href="#traits-and-phenotyping-initialization" class="anchor" aria-hidden="true"></a>Traits and phenotyping initialization</h2>
<p>In order to do some phenotyping simulation, we need to create a trait.</p>
<p>We will use for that the example data <code>exampleData$snpEffects</code> containing the “true” effects of each QTN.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exampleData</span><span class="op">$</span><span class="va">snpEffects</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>
<span class="co">#&gt;   snp00006   snp00009   snp00011   snp00018   snp00026 </span>
<span class="co">#&gt; 0.05110930 0.08099233 0.18353259 0.02819434 0.14413695</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">weight</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/trait.html">trait</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Weight"</span>,
                    qtn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">exampleData</span><span class="op">$</span><span class="va">snpEffects</span><span class="op">)</span>,
                    qtnEff <span class="op">=</span> <span class="va">exampleData</span><span class="op">$</span><span class="va">snpEffects</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">weight</span><span class="op">)</span>
<span class="co">#&gt; trait: Weight</span>
<span class="co">#&gt; quantitative trait</span>
<span class="co">#&gt; number of QTN: 3333</span></code></pre></div>
<p>This trait object contain the genetic effects but in order to simulate phenotyping experiments, we should also include some environmental effects.</p>
<p>The environmental effect will be stored in the <code>phenotyper</code> object. Here we create a phenotyper for which the mean of the phenotypic value is equal to 100 and the initial population have an heritability of 0.6, and the cost for phenotyping one plot is 150.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">phenolab</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/phenotyper.html">phenotyper</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Pheno lab"</span>,
                           traits <span class="op">=</span> <span class="va">weight</span>,
                           plotCost <span class="op">=</span> <span class="fl">150</span>,
                           mu <span class="op">=</span> <span class="fl">100</span>,
                           he <span class="op">=</span> <span class="fl">0.6</span>,
                           pop <span class="op">=</span> <span class="va">initPop</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">phenolab</span><span class="op">)</span>
<span class="co">#&gt; Phenotyper: Pheno lab</span>
<span class="co">#&gt; Traits: Weight</span>
<span class="co">#&gt; μ: 100</span>
<span class="co">#&gt; σ2: 25.6340237938445</span>
<span class="co">#&gt; Phenotyping cost (per plot): 150</span>
<span class="co">#&gt; timeEffect:</span></code></pre></div>
</div>
</div>
<div id="breeding-simulation" class="section level1">
<h1 class="hasAnchor">
<a href="#breeding-simulation" class="anchor" aria-hidden="true"></a>Breeding simulation</h1>
<p>Now the simulation is setup, we can write the simulation code using the objects defined previously. For this example we will simulate a simple breeding scheme consisting in phenotyping individuals and selecting those with the highest phenotypic values and cross them together.</p>
<div id="phenotyping-individuals" class="section level2">
<h2 class="hasAnchor">
<a href="#phenotyping-individuals" class="anchor" aria-hidden="true"></a>phenotyping individuals</h2>
<p>First, let’s phenotype the initial population</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1809</span><span class="op">)</span> <span class="co"># set seed </span>

<span class="va">pheno</span> <span class="op">&lt;-</span> <span class="va">phenolab</span><span class="op">$</span><span class="fu">trial</span><span class="op">(</span>pop <span class="op">=</span> <span class="va">initPop</span>, rep <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">pheno</span><span class="op">$</span><span class="va">data</span>
<span class="co">#&gt;        ind    Weight rep phenotyper</span>
<span class="co">#&gt; 1 Coll0001  95.72423   1  Pheno lab</span>
<span class="co">#&gt; 2 Coll0001 102.72287   2  Pheno lab</span>
<span class="co">#&gt; 3 Coll0001  96.19940   3  Pheno lab</span>
<span class="co">#&gt; 4 Coll0002 105.09960   1  Pheno lab</span>
<span class="co">#&gt; 5 Coll0002 102.24307   2  Pheno lab</span>
<span class="co">#&gt; 6 Coll0002 102.28673   3  Pheno lab</span>
<span class="co">#&gt;  [ reached 'max' / getOption("max.print") -- omitted 294 rows ]</span>
<span class="va">pheno</span><span class="op">$</span><span class="va">cost</span>
<span class="co">#&gt; [1] 45000</span></code></pre></div>
<p>The <code>trial</code> method of the <code>phenotyper</code> class return a list:</p>
<ul>
<li>
<code>data</code>: containing a <code>data.frame</code> of the phenotypic data</li>
<li>
<code>cost</code>: a numeric value representing the cost of the trial.</li>
</ul>
</div>
<div id="selecting-individuals" class="section level2">
<h2 class="hasAnchor">
<a href="#selecting-individuals" class="anchor" aria-hidden="true"></a>Selecting individuals</h2>
<p>Here we will just select the individuals with the highest phenotypic values.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># aggregate result by individual</span>
<span class="va">aggPheno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">Weight</span> <span class="op">~</span> <span class="va">ind</span>, data <span class="op">=</span> <span class="va">pheno</span><span class="op">$</span><span class="va">data</span>, <span class="va">mean</span><span class="op">)</span> 

<span class="co"># sort result by "Weight" in ascending order</span>
<span class="va">aggPheno</span> <span class="op">&lt;-</span> <span class="va">aggPheno</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">aggPheno</span><span class="op">$</span><span class="va">Weight</span>, decreasing <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,<span class="op">]</span>

<span class="co"># set selection intensity</span>
<span class="va">i</span> <span class="op">=</span> <span class="fl">0.1</span>

<span class="co"># calculated number of selected individuals</span>
<span class="va">nSelected</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">initPop</span><span class="op">$</span><span class="va">nInd</span> <span class="op">*</span> <span class="va">i</span><span class="op">)</span>
  
<span class="co"># get names of selected individuals</span>
<span class="va">selectedInds</span> <span class="op">=</span> <span class="va">aggPheno</span><span class="op">$</span><span class="va">ind</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">nSelected</span><span class="op">]</span>
<span class="va">selectedInds</span>
<span class="co">#&gt;  [1] "Coll0068" "Coll0008" "Coll0074" "Coll0020" "Coll0045" "Coll0016"</span>
<span class="co">#&gt;  [7] "Coll0037" "Coll0036" "Coll0079" "Coll0046"</span></code></pre></div>
</div>
<div id="crossing-individuals" class="section level2">
<h2 class="hasAnchor">
<a href="#crossing-individuals" class="anchor" aria-hidden="true"></a>Crossing individuals</h2>
<p>In order to cross the individuals we need to create a crossing table specifying:</p>
<ul>
<li>the first parent: <code>ind1</code>
</li>
<li>the second parent: <code>ind2</code>
</li>
<li>number of progenies for these two parents: <code>n</code>
</li>
<li>name of the progenies: <code>name</code>
</li>
</ul>
<p>In this example we will randomly cross the individuals together to create 100 new individuals. The function <code>randomMate</code> can generate such table.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">crossTable</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/randomMate.html">randomMate</a></span><span class="op">(</span><span class="va">selectedInds</span>, <span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"gen-2_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">crossTable</span>
<span class="co">#&gt;       ind1     ind2 n   names</span>
<span class="co">#&gt; 1 Coll0079 Coll0046 1 gen-2_1</span>
<span class="co">#&gt; 2 Coll0037 Coll0016 1 gen-2_2</span>
<span class="co">#&gt; 3 Coll0045 Coll0068 1 gen-2_3</span>
<span class="co">#&gt; 4 Coll0036 Coll0074 1 gen-2_4</span>
<span class="co">#&gt; 5 Coll0045 Coll0074 1 gen-2_5</span>
<span class="co">#&gt; 6 Coll0068 Coll0008 1 gen-2_6</span>
<span class="co">#&gt;  [ reached 'max' / getOption("max.print") -- omitted 94 rows ]</span></code></pre></div>
<p>Now we have specified the crosses to do, the function <code>makeCrosses</code> will create new individuals and return them as a list:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">newIndsList</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeCrosses.html">makeCrosses</a></span><span class="op">(</span><span class="va">crossTable</span>, <span class="va">initPop</span><span class="op">)</span></code></pre></div>
<p>We can integrate these new individuals in a new population:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">newPop</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/population.html">population</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"generation 2"</span>,
                         inds <span class="op">=</span> <span class="va">newIndsList</span>,
                         verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
</div>
<div id="automatisation" class="section level2">
<h2 class="hasAnchor">
<a href="#automatisation" class="anchor" aria-hidden="true"></a>Automatisation</h2>
<p>We have created one new generation, let’s create 3 more generations other generation automatically integrating the code above in one loop.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a list with all our populations</span>
<span class="va">popList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"list"</span>, length <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="va">popList</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">initPop</span>
<span class="va">popList</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">newPop</span>


<span class="kw">for</span> <span class="op">(</span><span class="va">gen</span> <span class="kw">in</span> <span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># phenotyping</span>
  <span class="va">pheno</span> <span class="op">&lt;-</span> <span class="va">phenolab</span><span class="op">$</span><span class="fu">trial</span><span class="op">(</span>pop <span class="op">=</span> <span class="va">popList</span><span class="op">[[</span><span class="va">gen</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, rep <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
  
  <span class="co"># select individuals</span>
  <span class="va">aggPheno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">Weight</span> <span class="op">~</span> <span class="va">ind</span>, data <span class="op">=</span> <span class="va">pheno</span><span class="op">$</span><span class="va">data</span>, <span class="va">mean</span><span class="op">)</span> 
  <span class="va">aggPheno</span> <span class="op">&lt;-</span> <span class="va">aggPheno</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">aggPheno</span><span class="op">$</span><span class="va">Weight</span>, decreasing <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,<span class="op">]</span>
  <span class="va">nSelected</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">initPop</span><span class="op">$</span><span class="va">nInd</span> <span class="op">*</span> <span class="va">i</span><span class="op">)</span>
  <span class="va">selectedInds</span> <span class="op">=</span> <span class="va">aggPheno</span><span class="op">$</span><span class="va">ind</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">nSelected</span><span class="op">]</span>
  
  <span class="co"># cross individuals</span>
  <span class="va">crossTable</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/randomMate.html">randomMate</a></span><span class="op">(</span>inds <span class="op">=</span> <span class="va">selectedInds</span>,
                           n <span class="op">=</span> <span class="fl">100</span>,
                           names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"gen-"</span>, <span class="va">gen</span>,<span class="st">"_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="va">newIndsList</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeCrosses.html">makeCrosses</a></span><span class="op">(</span><span class="va">crossTable</span>, <span class="va">popList</span><span class="op">[[</span><span class="va">gen</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
  
  <span class="co"># create new population</span>
  <span class="va">popList</span><span class="op">[[</span><span class="va">gen</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/population.html">population</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"generation"</span>, <span class="va">gen</span><span class="op">)</span>,
                                   inds <span class="op">=</span> <span class="va">newIndsList</span>,
                                   verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  
<span class="op">}</span>
<span class="va">popList</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; Population: Initial population</span>
<span class="co">#&gt; Species: Statisticae exempli</span>
<span class="co">#&gt; Number of individuals: 100</span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; Population: generation 2</span>
<span class="co">#&gt; Species: Statisticae exempli</span>
<span class="co">#&gt; Number of individuals: 100</span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; Population: generation 3</span>
<span class="co">#&gt; Species: Statisticae exempli</span>
<span class="co">#&gt; Number of individuals: 100</span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt; Population: generation 4</span>
<span class="co">#&gt; Species: Statisticae exempli</span>
<span class="co">#&gt; Number of individuals: 100</span>
<span class="co">#&gt; [[5]]</span>
<span class="co">#&gt; Population: generation 5</span>
<span class="co">#&gt; Species: Statisticae exempli</span>
<span class="co">#&gt; Number of individuals: 100</span></code></pre></div>
<p>Let’s look at the true genetic values of each population:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create data.table with all genetic values</span>
<span class="va">GVs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">popList</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pop</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>gvWeight <span class="op">=</span> <span class="va">weight</span><span class="op">$</span><span class="fu">gv</span><span class="op">(</span><span class="va">pop</span><span class="op">)</span>, pop <span class="op">=</span> <span class="va">pop</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span><span class="op">)</span>

<span class="co"># set pop variable as factor</span>
<span class="va">GVs</span><span class="op">$</span><span class="va">pop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">GVs</span><span class="op">$</span><span class="va">pop</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">GVs</span><span class="op">$</span><span class="va">pop</span><span class="op">)</span><span class="op">)</span>

<span class="co"># create boxplot</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">gvWeight</span><span class="op">~</span><span class="va">pop</span>,data<span class="op">=</span><span class="va">GVs</span><span class="op">)</span></code></pre></div>
<p><img src="example_files/figure-html/unnamed-chunk-12-1.png" width="768"></p>
</div>
</div>
<div id="conclusion" class="section level1">
<h1 class="hasAnchor">
<a href="#conclusion" class="anchor" aria-hidden="true"></a>Conclusion</h1>
<p>We have build an algorithm for simulating a simple breeding camping. In order to create more advance simulation, users can create their own functions for selecting, mating individuals using the classes provided by <code>breedSimulatR</code>. An exhaustive list of the fields and methods available for each class can be found in the documentation of the package and on <a href="https://ut-biomet.github.io/breedSimulatR/reference/index.html">the package’s web site</a>.</p>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor" aria-hidden="true"></a>References</h2>
<div id="refs" class="references">
<div id="ref-PlantBreedGame">
<p>Flutre, Timothée, Julien Diot, and Jacques David. 2019. “PlantBreedGame, A Serious Game That Puts Students in the Breeder’s Seat.” <em>Crop Science</em> 59 (October): 1374–5. <a href="https://doi.org/10.2135/cropsci2019.03.0183le" class="external-link">https://doi.org/10.2135/cropsci2019.03.0183le</a>.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Julien Diot.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
